<div class="cf flex flex-wrap">
    <div class="f5 fl mr4">
        <span class="f1 korolev big-numbers">{{ data.count|_n }}</span><br>
        {% trans count=data.count %}NGO found{% pluralize %}NGOs found{% endtrans %}
    </div>
    {% if data.total_income %}
    <div class="f5 fl mr4">
        <span class="f1 korolev big-numbers">£{{ data.total_income|number_format }}</span><br>
        {% trans %}Total income*{% endtrans %}
    </div>
        {% if all_charity_data.total_income %}
        {% set proportion = (data.total_income / all_charity_data.total_income) %}
        {% set precision = 1 if proportion < 0.0095 else 0 %}
        <div class="f5 fl mr4">
            <span class="f1 korolev big-numbers">
            {% if proportion < 0.001 %}
            &lt;0.1%
            {% else %}
            {{ "{:.{prec}%}".format(proportion, prec=precision) }}
            {% endif %}
            </span><br>
            {% trans %}of all charity income{% endtrans %}
        </div>
        {% endif %}
    {% endif %}
</div>
<h3 class="f5">{% trans %}Example NGOs{% endtrans %}</h3>
<dl>
{% for c in data.list|randomn(3) %}
    <dt class="b">
        <a class="link blue b" href="{{ url_for('data.charity', charityid=c.id) }}">
            {{ c.name|correct_titlecase }}
        </a>
    </dt>
    <dd class="mw6-l ml0 mb2">
        <p class="f6 pa0 ma0 lh-copy">
            {% if c.finances and c.finances[0].income %}
            {% trans %}Income{% endtrans %} <strong>£{{ c.finances[0].income|number_format }}</strong>
            <span class="f7 i gray">({{ c.finances[0].financialYear.end.year }})</span>
            {% endif %}
        </p>
        {% if area %}
        <p class="f7 dark-gray pa0 ma0">
            {% set cids = area.countries|map(attribute="id")|list %}
            {% trans %}Work in{% endtrans %} 
            {% for a in c.countries if a.id in cids %}
                {%- if loop.last and not loop.first %} {{ _("and") }} {% endif %}
                {%- if not loop.last and not loop.first -%}, {% endif %}
                {{- a.name -}}
            {% endfor %}
        </p>
        {% endif %}
    </dd>
{% endfor %}
</dl>
<p class="pa0 ma0 f7 gray">
    * {% trans %}Total income includes all activities of the matched organisations, and is not
    just limited to the activities in the selected country/countries.{% endtrans %}
    {% if data.total_income_years %}
    {% trans latest_year=data.total_income_years|dictsort(false, 'value', true)|first|first %}
    Total income is based on the latest available income for these organisations. The latest
    available data is from {{ latest_year }}, though for some organisations it may be earlier.
    {% endtrans %}
    {% endif %}
</p>
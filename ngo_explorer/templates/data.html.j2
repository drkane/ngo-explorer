{% extends "base.html.j2" %}

{% block title %}{{ area.name|first_upper }} | NGO Explorer{% endblock %}

{% macro figure(chart_id, caption=None) %}
<figure class="fl w-100 w-50-l pr3-l mh0 mv2">
    <figcaption class="f4 b mv2 lh-title">{{ caption }}</figcaption>
    <div id="chart_{{ chart_id }}"></div>
</figure>
{% endmacro %}

{% block content %}
{% set active_page =  "dashboard" %}
{% include '_data_header.html.j2' %}
<div class="w-100 cf mt2">
    <form action="{{request.path}}" id="filter-form">
        {% include '_data_sidebar.html.j2' %}
    </form>

    <div class="fl w-100 w-80-l flex flex-wrap">

        <figure class="fl w-100 w-50-l pr3-l mh0 mv2">
            <div id="example-charities" class=" bg-light-gray pa4 br3">
            {% include '_data_example_charities.html.j2' %}
            </div>
        </figure>

        {{ figure("count", "Number of charities by size")}}
        {{ figure("amount", "Amount of income by size (Â£)")}}
        <figure class="fl w-100 w-50-l pr3-l mh0 mv2">
            <figcaption class="f4 b mv1 lh-title">How NGOs describe themselves</figcaption>
            <div id="word-cloud">
            {% include '_data_word_cloud.html.j2' %}
            </div>
        </figure>
        {{ figure("countries", "Where else do these charities work?")}}
        {% for k in ["causes", "beneficiaries", "operations"] %}
        {{ figure(k, k|title )}}
        {% endfor %}
    </div>
</div>

{% include '_data_iati.html.j2' %}
{% include '_data_other_resources.html.j2' %}
{% endblock %}

{% block scripts %}
<script>
    const api_url = '{{ api_url }}';
    {% if data.charts %}
    const charts = {{ data.charts|to_plotlyjson }};
    {% endif %}
</script>
{{ super() }}
<script src="{{ url_for('static', filename='vendor/choices/choices.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendor/dom-purify/purify.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/data.js') }}"></script>
{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='vendor/choices/choices.min.css') }}">
{{ super() }}
{% endblock %}